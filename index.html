<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
<title>–ó–∞–∫–∞–∑ –¥–æ—Å—Ç–∞–≤–∫–∏</title>
<style>
  /* --- –ë–∞–∑–æ–≤—ã–µ —Å—Ç–∏–ª–∏ --- */
  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: linear-gradient(135deg, #e0f0ff, #f7f9fc);
    margin: 0;
    padding: 15px 10px;
    color: #333;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    align-items: center;
  }
  h2 {
    text-align: center;
    color: #0077cc;
    margin-bottom: 25px;
    font-weight: 700;
    font-size: 1.8rem;
  }
  form {
    width: 100%;
    max-width: 420px;
    background: #fff;
    padding: 25px 30px 30px;
    border-radius: 14px;
    box-shadow: 0 8px 20px rgba(0, 119, 204, 0.15);
    box-sizing: border-box;
  }
  label {
    font-weight: 600;
    display: block;
    margin-bottom: 8px;
    font-size: 1rem;
    color: #444;
  }
  input[type="tel"],
  input[type="file"],
  input[type="text"] {
    width: 100%;
    padding: 14px 15px;
    border-radius: 12px;
    border: 1.8px solid #bbb;
    font-size: 1rem;
    box-sizing: border-box;
    transition: border-color 0.3s ease, box-shadow 0.3s ease;
    outline-offset: 2px;
  }
  input[type="tel"]:focus,
  input[type="file"]:focus,
  input[type="text"]:focus {
    border-color: #0077cc;
    box-shadow: 0 0 10px #0077ccaa;
    outline: none;
  }
  /* –§–æ—Ç–æ –ø—Ä–µ–≤—å—é */
  #photo-preview {
    max-width: 100%;
    margin-top: 12px;
    border-radius: 14px;
    box-shadow: 0 3px 12px rgba(0, 0, 0, 0.12);
    display: none;
    object-fit: contain;
  }
  /* –ö–Ω–æ–ø–∫–∏ */
  button {
    width: 100%;
    background-color: #0077cc;
    border: none;
    color: white;
    font-size: 1.15rem;
    padding: 14px 0;
    border-radius: 14px;
    cursor: pointer;
    margin-top: 20px;
    font-weight: 600;
    box-shadow: 0 4px 12px rgba(0, 119, 204, 0.25);
    transition: background-color 0.3s ease, box-shadow 0.3s ease;
  }
  button:hover {
    background-color: #005fa3;
    box-shadow: 0 6px 20px rgba(0, 95, 163, 0.45);
  }
  #get-current-location {
    width: auto;
    background-color: #28a745;
    box-shadow: 0 4px 12px rgba(40, 167, 69, 0.25);
    margin-top: 8px;
    padding: 12px 22px;
    font-weight: 700;
    font-size: 1rem;
    border-radius: 14px;
  }
  #get-current-location:hover {
    background-color: #218838;
    box-shadow: 0 6px 20px rgba(33, 136, 56, 0.45);
  }
  /* –°—Ç–∞—Ç—É—Å –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏ */
  #location-status {
    font-style: italic;
    margin: 10px 0 15px;
    color: #555;
    min-height: 22px;
    font-size: 0.9rem;
  }
  /* –†–∞–¥–∏–æ–∫–Ω–æ–ø–∫–∏ - —Å—Ç–∏–ª—å –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª–µ–π */
  .geo-options, .delivery-options {
    display: flex;
    gap: 15px;
    flex-wrap: wrap;
    margin-bottom: 20px;
  }
  .geo-options label, .delivery-options label {
    flex-grow: 1;
    position: relative;
    cursor: pointer;
    font-weight: 600;
    user-select: none;
    padding-left: 40px;
    color: #555;
    font-size: 1rem;
  }
  .geo-options input[type="radio"],
  .delivery-options input[type="radio"] {
    position: absolute;
    opacity: 0;
    cursor: pointer;
  }
  .geo-options input[type="radio"] + span,
  .delivery-options input[type="radio"] + span {
    position: relative;
    display: inline-block;
    padding: 10px 18px;
    border: 2px solid #bbb;
    border-radius: 20px;
    transition: all 0.3s ease;
    color: #555;
    font-weight: 600;
  }
  .geo-options input[type="radio"]:checked + span,
  .delivery-options input[type="radio"]:checked + span {
    background-color: #0077cc;
    color: white;
    border-color: #0077cc;
    box-shadow: 0 0 12px #0077ccaa;
  }
  /* –°–∫—Ä—ã–≤–∞–µ–º –¥–µ—Ñ–æ–ª—Ç–Ω—ã–µ —Ä–∞–¥–∏–æ–∫–Ω–æ–ø–∫–∏ */
  .geo-options input[type="radio"],
  .delivery-options input[type="radio"] {
    position: absolute;
    opacity: 0;
    width: 0;
    height: 0;
  }
  /* –î–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö: –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
  @media (max-width: 480px) {
    form {
      padding: 20px 20px 25px;
      border-radius: 12px;
    }
    button, #get-current-location {
      font-size: 1.1rem;
      padding: 12px 0;
      border-radius: 12px;
    }
    .geo-options, .delivery-options {
      flex-direction: column;
    }
    .geo-options label, .delivery-options label {
      padding-left: 35px;
      font-size: 1.1rem;
    }
  }
</style>
</head>
<body>

<h2>–û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –¥–æ—Å—Ç–∞–≤–∫–∏</h2>

<form id="order-form" autocomplete="off" novalidate>
  <label for="phone">–ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞:</label>
  <input
    type="tel"
    id="phone"
    name="phone"
    placeholder="+7XXXXXXXXXX"
    pattern="^\+7\d{10}$"
    required
    title="–í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä –≤ —Ñ–æ—Ä–º–∞—Ç–µ +7XXXXXXXXXX"
  />

  <label>–¢–∏–ø –¥–æ—Å—Ç–∞–≤–∫–∏:</label>
  <div class="delivery-options" role="radiogroup" aria-label="–¢–∏–ø –¥–æ—Å—Ç–∞–≤–∫–∏">
    <label>
      <input type="radio" id="delivery1" name="delivery_type" value="–û–±—ã—á–Ω–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞ (150‚ÇΩ)" checked />
      <span>–û–±—ã—á–Ω–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞ ‚Äî 150‚ÇΩ</span>
    </label>
    <label>
      <input type="radio" id="delivery2" name="delivery_type" value="–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–≤–∞—Ä–∞ –∫—É—Ä—å–µ—Ä–æ–º (200‚ÇΩ)" />
      <span>–ö—É—Ä—å–µ—Ä –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ç–æ–≤–∞—Ä ‚Äî 200‚ÇΩ</span>
    </label>
  </div>

  <label for="photo">–§–æ—Ç–æ —Ç–æ–≤–∞—Ä–∞:</label>
  <input type="file" id="photo" name="photo" accept="image/*" required />
  <img id="photo-preview" alt="–ü—Ä–µ–≤—å—é —Ñ–æ—Ç–æ" />

  <p class="geo-mode" style="font-weight:700; margin-bottom:8px;">–°–ø–æ—Å–æ–± —É–∫–∞–∑–∞–Ω–∏—è –≥–µ–æ–ø–æ–∑–∏—Ü–∏–∏:</p>
  <div class="geo-options" role="radiogroup" aria-label="–°–ø–æ—Å–æ–± —É–∫–∞–∑–∞–Ω–∏—è –≥–µ–æ–ø–æ–∑–∏—Ü–∏–∏">
    <label>
      <input type="radio" name="geo_mode" value="current" checked />
      <span>–¢–µ–∫—É—â–∞—è –ø–æ–∑–∏—Ü–∏—è</span>
    </label>
    <label>
      <input type="radio" name="geo_mode" value="address" />
      <span>–í–≤–µ—Å—Ç–∏ –∞–¥—Ä–µ—Å –≤—Ä—É—á–Ω—É—é</span>
    </label>
  </div>

  <button type="button" id="get-current-location">üìç –ü–æ–ª—É—á–∏—Ç—å —Ç–µ–∫—É—â—É—é –≥–µ–æ–ø–æ–∑–∏—Ü–∏—é</button>

  <input type="text" id="address-input" name="address" placeholder="–í–≤–µ–¥–∏—Ç–µ –∞–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏" style="display:none;" autocomplete="off" />

  <p id="location-status"></p>

  <input type="hidden" id="latitude" name="latitude" />
  <input type="hidden" id="longitude" name="longitude" />

  <button type="submit">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞–∫–∞–∑</button>
</form>

<script>
  const geoModeRadios = document.querySelectorAll('input[name="geo_mode"]');
  const getLocationBtn = document.getElementById('get-current-location');
  const locationStatus = document.getElementById('location-status');
  const addressInput = document.getElementById('address-input');
  const latitudeInput = document.getElementById('latitude');
  const longitudeInput = document.getElementById('longitude');
  const photoInput = document.getElementById('photo');
  const photoPreview = document.getElementById('photo-preview');
  const phoneInput = document.getElementById('phone');

  function toggleGeoInput() {
    const selected = document.querySelector('input[name="geo_mode"]:checked').value;
    if (selected === 'current') {
      getLocationBtn.style.display = 'inline-block';
      addressInput.style.display = 'none';
      addressInput.value = '';
      latitudeInput.value = '';
      longitudeInput.value = '';
      locationStatus.textContent = '';
    } else {
      getLocationBtn.style.display = 'none';
      addressInput.style.display = 'block';
      latitudeInput.value = '';
      longitudeInput.value = '';
      locationStatus.textContent = '';
    }
  }

  geoModeRadios.forEach(radio => {
    radio.addEventListener('change', toggleGeoInput);
  });

  getLocationBtn.addEventListener('click', () => {
    if (!navigator.geolocation) {
      locationStatus.textContent = '–ì–µ–æ–ª–æ–∫–∞—Ü–∏—è –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –≤–∞—à–∏–º –±—Ä–∞—É–∑–µ—Ä–æ–º';
      return;
    }
    locationStatus.textContent = '–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏—è...';
    navigator.geolocation.getCurrentPosition(
      (position) => {
        locationStatus.textContent = `–®–∏—Ä–æ—Ç–∞: ${position.coords.latitude.toFixed(6)}, –î–æ–ª–≥–æ—Ç–∞: ${position.coords.longitude.toFixed(6)}`;
        latitudeInput.value = position.coords.latitude;
        longitudeInput.value = position.coords.longitude;
      },
      (error) => {
        switch(error.code) {
          case error.PERMISSION_DENIED:
            locationStatus.textContent = '–î–æ—Å—Ç—É–ø –∫ –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏ –∑–∞–ø—Ä–µ—â—ë–Ω';
            break;
          case error.POSITION_UNAVAILABLE:
            locationStatus.textContent = '–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞';
            break;
          case error.TIMEOUT:
            locationStatus.textContent = '–ü—Ä–µ–≤—ã—à–µ–Ω–æ –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è –∑–∞–ø—Ä–æ—Å–∞ –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏';
            break;
          default:
            locationStatus.textContent = '–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏';
        }
      }
    );
  });

  photoInput.addEventListener('change', (e) => {
    const file = e.target.files[0];
    if (file) {
      const reader = new FileReader();
      reader.onload = function(evt) {
        photoPreview.src = evt.target.result;
        photoPreview.style.display = 'block';
      };
      reader.readAsDataURL(file);
    } else {
      photoPreview.style.display = 'none';
      photoPreview.src = '';
    }
  });

  document.getElementById('order-form').addEventListener('submit', (e) => {
    e.preventDefault();

    // –í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–æ–º–µ—Ä–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞
    if (!phoneInput.checkValidity()) {
      alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ +7XXXXXXXXXX');
      phoneInput.focus();
      return;
    }

    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—ã–±–æ—Ä–∞ —Ñ–æ—Ç–æ
    if (!photoInput.files.length) {
      alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø—Ä–∏–∫—Ä–µ–ø–∏—Ç–µ —Ñ–æ—Ç–æ —Ç–æ–≤–∞—Ä–∞');
      photoInput.focus();
      return;
    }

    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥–µ–æ–ø–æ–∑–∏—Ü–∏–∏
    const geoMode = document.querySelector('input[name="geo_mode"]:checked').value;
    if (geoMode === 'current') {
      if (!latitudeInput.value || !longitudeInput.value) {
        alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ª—É—á–∏—Ç–µ –≤–∞—à—É —Ç–µ–∫—É—â—É—é –≥–µ–æ–ø–æ–∑–∏—Ü–∏—é');
        getLocationBtn.focus();
        return;
      }
    } else {
      if (!addressInput.value.trim()) {
        alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –∞–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏');
        addressInput.focus();
        return;
      }
    }

    // –°–æ–±–∏—Ä–∞–µ–º –¥–∞–Ω–Ω—ã–µ —Ñ–æ—Ä–º—ã
    const formData = new FormData(e.target);

    // –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞ –≤ –∫–æ–Ω—Å–æ–ª—å (–∑–¥–µ—Å—å –º–æ–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä)
    console.log('–î–∞–Ω–Ω—ã–µ –∑–∞–∫–∞–∑–∞:');
    for (const pair of formData.entries()) {
      console.log(`${pair[0]}: ${pair[1]}`);
    }

    alert('–ó–∞–∫–∞–∑ —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω!');

    // –°–±—Ä–æ—Å —Ñ–æ—Ä–º—ã –∏ —Å–∫—Ä—ã—Ç–∏–µ –ø—Ä–µ–≤—å—é —Ñ–æ—Ç–æ
    e.target.reset();
    photoPreview.style.display = 'none';
    locationStatus.textContent = '';
    latitudeInput.value = '';
    longitudeInput.value = '';
    toggleGeoInput();
  });

  toggleGeoInput();
</script>

</body>
</html>
